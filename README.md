# MDMS (Murder Mystery Detective System)
## Minecraft Bedrock Edition 推理ゲームアドオン

### 概要
MDMSは、Minecraft Bedrock Editionで動作する高度な推理ゲームシステムです。プレイヤーは犯人、共犯者、一般人の役職に分かれ、証拠の収集、推理、投票を通じて真犯人を見つけ出すゲームを楽しめます。

### 主要機能

#### 🎮 ゲームシステム
- **フェーズベース進行**: 準備→日常→捜査→議論→再捜査→推理→投票→終了
- **役職システム**: 犯人、共犯者、一般人の3つの役職
- **職業システム**: 探偵、医者、警備員、記者の特殊職業
- **タイマー管理**: 各フェーズの自動進行とカウントダウン

#### 🕵️ 証拠・推理システム
- **行動記録**: プレイヤーの全行動をリアルタイム追跡
- **証拠分析**: AI搭載の推理エンジンで自動分析
- **矛盾検出**: 証言と行動の矛盾を自動検出
- **目撃者システム**: 周囲のプレイヤーを自動的に目撃者として記録

#### 🗳️ 投票・勝利システム
- **多段階投票**: 犯人投票、追放投票、最終審判の3種類
- **スコアリング**: 行動、投票精度、証拠発見に基づく詳細スコア
- **勝利判定**: 自動的な勝利条件チェックとゲーム終了
- **MVP選出**: 最優秀プレイヤー、ベスト探偵、ベスト犯人の表彰

#### ⚡ 特殊能力システム
- **探偵能力**: 調査、証拠捜索、手がかり分析
- **医者能力**: 治療、検死、蘇生
- **警備員能力**: 護衛、巡回、警戒
- **記者能力**: インタビュー、放送、情報収集
- **犯人能力**: 殺人、妨害工作、変装
- **共犯者能力**: 協力、注意逸らし、隠蔽工作

#### 🛠️ 管理・デバッグシステム
- **管理者権限**: 5段階の権限レベル
- **システム監視**: リアルタイムパフォーマンス監視
- **デバッグ機能**: 完全なシステム状態出力
- **データ管理**: バックアップとリストア機能

### アイテムトリガー

| アイテム | 機能 |
|---------|------|
| 🕐 時計 | ゲーム開始 |
| 🔸 プリズマリンの欠片 | プレイヤー状態表示 |
| 💎 エメラルド | 全デバッグ情報出力 |
| 🔍 スパイグラス | 証拠メニュー |
| ✨ グロウストーン | 推理レポート |
| 🧱 ネザライトの欠片 | ロール・ジョブ再通知 |
| 🧭 コンパス | メインUIメニュー |
| 🗺️ 地図 | プレイヤー情報 |
| 📖 本 | ロールヘルプ |
| 🧱 レンガ | 職業ヘルプ |
| 👁️ エンダーアイ | 管理者メニュー |
| 🔴 レッドストーン | テスト殺人事件 |
| 📜 紙 | 投票システム |
| 🔥 ブレイズロッド | 能力メニュー |
| 🍎 金のリンゴ | ゲーム結果 |
| ⭐ ネザースター | 勝利条件チェック |
| ⚙️ コマンドブロック | システム統計 |
| 💎 ダイヤモンド | フェーズ強制変更 |

### システム要件
- Minecraft Bedrock Edition 1.20.0以降
- @minecraft/server API 2.0.0以降
- @minecraft/server-ui API 2.0.0以降
- プレイヤー数: 4-20人推奨

### セットアップ

1. 依存関係のインストール：
```bash
npm install
```

2. アドオンのビルド：
```bash
npm run build
```

3. `.mcaddon` ファイルの生成：
ビルド後、`MDMS.mcaddon` ファイルが生成されます。

4. Minecraftへのインポート：
- `.mcaddon` ファイルをダブルクリックするか、Minecraftで開く
- 新しいワールド作成時に「MDMS」アドオンを有効化
- ワールド設定で「実験的機能」を有効化

### ゲームの流れ

#### 1. 準備フェーズ (5分)
- プレイヤーに役職・職業を自動割り当て
- マップ散策とルール確認
- 特殊能力の確認

#### 2. 日常フェーズ (10分)  
- 自由行動時間
- 犯人は殺人を計画・実行
- 他プレイヤーは日常行動

#### 3. 捜査フェーズ (15分)
- 証拠収集と現場検証
- 特殊能力の活用
- 目撃者からの聞き込み

#### 4. 議論フェーズ (10分)
- 収集した証拠の共有
- 推理の発表
- 質疑応答

#### 5. 再捜査フェーズ (10分)
- 追加証拠の収集
- 矛盾点の確認
- 最終推理の準備

#### 6. 推理フェーズ (5分)
- 最終推理の発表
- 投票前の最終確認

#### 7. 投票フェーズ (5分)
- 犯人投票の実施
- リアルタイム集計
- 結果発表

#### 8. 終了フェーズ
- ゲーム結果の表示
- スコアランキング
- MVP表彰

### スコアリングシステム

#### 基本スコア
- **犯人**: 200点 (高難易度)
- **共犯者**: 150点 (中難易度) 
- **一般人**: 100点 (基本)

#### 行動スコア
- **正しい投票**: +100点
- **間違った投票**: -20点
- **証拠発見**: +50点
- **的確な推理**: +75点
- **生存ボーナス**: +30点

#### 職業倍率
- **探偵**: ×1.2 (推理ボーナス)
- **医者**: ×1.1 (治療ボーナス)
- **警備員**: ×1.1 (護衛ボーナス)
- **記者**: ×1.15 (情報ボーナス)

### 管理者機能

#### ゲーム制御
- ゲーム開始/終了/リセット
- フェーズ強制変更
- 緊急停止

#### プレイヤー管理  
- 役職・職業変更
- プレイヤー殺害/蘇生
- テレポート

#### システム監視
- リアルタイム統計
- パフォーマンス監視
- エラーログ確認

#### デバッグ機能
- 全システム状態出力
- 行動追跡切り替え
- イベント注入

### トラブルシューティング

#### よくある問題

**Q: ゲームが開始されない**
A: プレイヤー数が4人未満、または実験的機能が無効になっている可能性があります。

**Q: 能力が使用できない**
A: フェーズ制限、使用回数制限、またはクールダウン中の可能性があります。

**Q: 投票ができない**
A: 投票権がない、または既に投票済みの可能性があります。

**Q: スコアが表示されない**
A: ゲームがまだ終了していない、またはシステムエラーが発生している可能性があります。

#### エラー対処

1. **システムリセット**: レッドストーンアイテムでゲームリセット
2. **デバッグ出力**: エメラルドアイテムで詳細情報確認
3. **管理者機能**: エンダーアイでシステム状態確認

### 開発情報

#### アーキテクチャ
- **マネージャーパターン**: 各機能を独立したマネージャーで管理
- **シングルトンパターン**: システム全体で一意なインスタンス
- **イベント駆動**: ScriptEventによる疎結合な通信
- **TypeScript**: 完全な型安全性

#### 主要コンポーネント
- **ScoreboardManager**: ゲーム状態管理
- **PhaseManager**: フェーズ進行制御
- **ActionTrackingManager**: 行動記録・追跡
- **EvidenceAnalyzer**: AI推理エンジン
- **VotingManager**: 投票システム
- **ScoringManager**: スコア計算・勝利判定
- **AbilityManager**: 特殊能力システム
- **AdminManager**: 管理者機能

### プロジェクト構造

```
MDMS/
├── src/
│   ├── main.ts               # メインスクリプト
│   ├── managers/             # システム管理クラス群
│   │   ├── ScoreboardManager.ts
│   │   ├── PhaseManager.ts
│   │   ├── ActionTrackingManager.ts
│   │   ├── EvidenceAnalyzer.ts
│   │   ├── VotingManager.ts
│   │   ├── ScoringManager.ts
│   │   ├── AbilityManager.ts
│   │   └── AdminManager.ts
│   ├── types/                # 型定義
│   │   ├── PhaseTypes.ts
│   │   ├── ActionTypes.ts
│   │   ├── VotingTypes.ts
│   │   ├── ScoringTypes.ts
│   │   └── AbilityTypes.ts
│   └── ui/                   # UI管理クラス群
├── dist/                     # ビルド出力
├── manifest.json            # アドオン設定
├── package.json            # プロジェクト設定
└── tsconfig.json           # TypeScript設定
```

### ライセンス
MIT License

### 作者
Claude (Anthropic AI)

### バージョン履歴
- **v1.0.0**: 初回リリース
  - 完全なゲームシステム実装
  - 5フェーズ開発完了
  - 全機能統合テスト完了

### サポート
バグ報告や機能要望は、GitHub Issuesまでお願いします。

---

**楽しい推理ゲームをお楽しみください！** 🕵️‍♀️🔍